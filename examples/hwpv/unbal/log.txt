C:\src\pecblocks\examples\hwpv>python pv3_training.py
model_folder = ./unbal
model_root = unbal
data_path = ../../../atptools/unbalanced.hdf5
idx_in [0, 1, 2, 3, 4, 5, 6, 7, 8]
idx_out [9, 10, 11, 12, 13, 14, 15, 16]
read 2310 dataframes
dt=0.002000 data_len=2500 n_io=17 n_case=2310
['T', 'G', 'Fc', 'Md', 'Mq', 'Vrms', 'GVrms', 'Ctl', 'Unb'] ['Vdc', 'Idc', 'Idlo', 'Iqlo', 'I0lo', 'Idhi', 'Iqhi', 'I0hi'] (2310, 2500, 17)
shapes of t (2500,) data_train (2310, 2500, 17) n_in=9, n_out=8
t range 0.000000 to 4.998000
Before Scaling:
Column       Min       Max      Mean     Range
T         15.000    35.003    26.754    20.003
G         -0.000   999.995   403.273   999.995
Fc        55.000    65.000    60.002    10.000
Md         0.800     1.200     1.001     0.400
Mq        -0.499     0.501     0.001     1.000
Vrms       0.000   575.565   116.056   575.565
GVrms     -0.000   546.787    69.094   546.787
Ctl        0.000     1.000     0.599     1.000
Unb        0.000     1.000     0.140     1.000
Vdc       -0.000   443.094   273.609   443.094
Idc       -0.000   292.836   103.908   292.836
Idlo      -0.270   189.458    67.640   189.727
Iqlo     -81.686    72.976    -1.439   154.661
I0lo      -0.788     0.496    -0.000     1.283
Idhi      -0.123    15.174     0.621    15.297
Iqhi      -0.288    15.248     0.617    15.536
I0hi      -0.290    14.641     0.614    14.932
After Scaling:
Column       Min       Max      Mean     Range     Scale    Offset
T         -0.588     0.412     0.000     1.000    20.003    26.754
G         -0.403     0.597    -0.000     1.000   999.995   403.273
Fc        -0.500     0.500    -0.000     1.000    10.000    60.002
Md        -0.502     0.498    -0.000     1.000     0.400     1.001
Mq        -0.500     0.500     0.000     1.000     1.000     0.001
Vrms      -0.202     0.798     0.000     1.000   575.565   116.056
GVrms     -0.126     0.874     0.000     1.000   546.787    69.094
Ctl       -0.599     0.401    -0.000     1.000     1.000     0.599
Unb       -0.140     0.860     0.000     1.000     1.000     0.140
Vdc       -0.617     0.383     0.000     1.000   443.094   273.609
Idc       -0.355     0.645    -0.000     1.000   292.836   103.908
Idlo      -0.358     0.642    -0.000     1.000   189.727    67.640
Iqlo      -0.519     0.481     0.000     1.000   154.661    -1.439
I0lo      -0.614     0.386     0.000     1.000     1.283    -0.000
Idhi      -0.049     0.951    -0.000     1.000    15.297     0.621
Iqhi      -0.058     0.942    -0.000     1.000    15.536     0.617
I0hi      -0.061     0.939    -0.000     1.000    14.932     0.614
make_mimo_block iir
Iter    0 of  600 | Loss     0.058970
Iter   10 of  600 | Loss     0.041798
Iter   20 of  600 | Loss     0.032816
Iter   30 of  600 | Loss     0.019319
Iter   40 of  600 | Loss     0.014832
Iter   50 of  600 | Loss     0.012261
Iter   60 of  600 | Loss     0.010738
Iter   70 of  600 | Loss     0.009827
Iter   80 of  600 | Loss     0.009297
Iter   90 of  600 | Loss     0.008533
Iter  100 of  600 | Loss     0.007627
Iter  110 of  600 | Loss     0.006901
Iter  120 of  600 | Loss     0.006382
Iter  130 of  600 | Loss     0.006002
Iter  140 of  600 | Loss     0.005690
Iter  150 of  600 | Loss     0.005409
Iter  160 of  600 | Loss     0.005093
Iter  170 of  600 | Loss     0.004726
Iter  180 of  600 | Loss     0.004356
Iter  190 of  600 | Loss     0.004073
Iter  200 of  600 | Loss     0.003894
Iter  210 of  600 | Loss     0.003786
Iter  220 of  600 | Loss     0.003719
Iter  230 of  600 | Loss     0.003666
Iter  240 of  600 | Loss     0.003622
Iter  250 of  600 | Loss     0.003584
Iter  260 of  600 | Loss     0.003548
Iter  270 of  600 | Loss     0.003516
Iter  280 of  600 | Loss     0.003479
Iter  290 of  600 | Loss     0.003445
Iter  300 of  600 | Loss     0.003409
Iter  310 of  600 | Loss     0.003376
Iter  320 of  600 | Loss     0.003335
Iter  330 of  600 | Loss     0.003297
Iter  340 of  600 | Loss     0.003261
Iter  350 of  600 | Loss     0.003227
Iter  360 of  600 | Loss     0.003183
Iter  370 of  600 | Loss     0.003150
Iter  380 of  600 | Loss     0.003116
Iter  390 of  600 | Loss     0.003108
Iter  400 of  600 | Loss     0.003059
Iter  410 of  600 | Loss     0.003033
Iter  420 of  600 | Loss     0.003007
Iter  430 of  600 | Loss     0.002982
Iter  440 of  600 | Loss     0.002956
Iter  450 of  600 | Loss     0.003008
Iter  460 of  600 | Loss     0.002911
Iter  470 of  600 | Loss     0.002890
Iter  480 of  600 | Loss     0.002859
Iter  490 of  600 | Loss     0.002836
Iter  500 of  600 | Loss     0.002812
Iter  510 of  600 | Loss     0.002789
Iter  520 of  600 | Loss     0.002768
Iter  530 of  600 | Loss     0.002748
Iter  540 of  600 | Loss     0.002733
Iter  550 of  600 | Loss     0.002714
Iter  560 of  600 | Loss     0.002700
Iter  570 of  600 | Loss     0.002685
Iter  580 of  600 | Loss     0.002672
Iter  590 of  600 | Loss     0.002659
COL_Y ['Vdc', 'Idc', 'Idlo', 'Iqlo', 'I0lo', 'Idhi', 'Iqhi', 'I0hi']
Train time: 43134.48, Recent loss: 0.002654, RMS Errors: 0.0845 0.0335 0.0328 0.0289 0.0123 0.0584 0.0576 0.0603
                          MAE Errors: 0.0503 0.0213 0.0207 0.0173 0.0056 0.0225 0.0219 0.0225

C:\src\pecblocks\examples\hwpv>python pv3_export.py
Read Model from: ./unbal/unbal_config.json
Export Model to: ./unbal\unbal_fhf.json
idx_in [0, 1, 2, 3, 4, 5, 6, 7, 8]
idx_out [9, 10, 11, 12, 13, 14, 15, 16]
make_mimo_block iir
H1s[0][0]  Real Poles: [-574.395768   -574.395768   -424.31760498 -424.31760498] Freqs [Hz]: [9.061423169296182, 10.218711925850124]
H1s[0][1]  Real Poles: [-756.85409534 -524.22959021 -524.22959021 -153.61739174] Freqs [Hz]: [41.96974219306473]
H1s[0][2]  Real Poles: [-710.50837644 -525.7016578  -525.7016578  -209.55806418] Freqs [Hz]: [35.75567225496196]
H1s[0][3]  Real Poles: [-764.24823766 -528.2254568  -528.2254568  -123.31719357] Freqs [Hz]: [44.26478216791845]
H1s[0][4]  Real Poles: [-769.61321653 -529.96613829 -529.96613829 -104.80655463] Freqs [Hz]: [44.41651183651231]
H1s[0][5]  Real Poles: [-620.16134911 -620.16134911 -384.88250909 -384.88250909] Freqs [Hz]: [17.241308703044027, 21.22410933139557]
H1s[0][6]  Real Poles: [-689.9025996  -517.72554052 -517.72554052 -269.25229878] Freqs [Hz]: [32.62034180623831]
H1s[0][7]  Real Poles: [-730.11356848 -519.84028313 -519.84028313 -196.63620523] Freqs [Hz]: [37.63335035611926]
H1s[1][0]  Real Poles: [-698.73314713 -516.22753611 -516.22753611 -259.77105709] Freqs [Hz]: [33.33676883305309]
H1s[1][1]  Real Poles: [-668.48283403 -504.65007936 -504.65007936 -323.15605345] Freqs [Hz]: [27.470444374155537]
H1s[1][2]  Real Poles: [-734.78375829 -525.08049947 -525.08049947 -176.16469098] Freqs [Hz]: [38.796760874745964]
H1s[1][3]  Real Poles: [-615.47680812 -615.47680812 -386.82702735 -386.82702735] Freqs [Hz]: [18.023965099563707, 17.531008825338827]
H1s[1][4]  Real Poles: [-615.40629018 -460.81875992 -460.81875992 -459.86375991] Freqs [Hz]: [12.443439726004875]
H1s[1][5]  Real Poles: [-803.7633071  -535.09564083 -535.09564083  -19.03961391] Freqs [Hz]: [50.114074396675385]
H1s[1][6]  Real Poles: [-657.79196711 -521.55534136 -521.55534136 -286.21369444] Freqs [Hz]: [27.482182614265973]
H1s[1][7]  Real Poles: [-664.56301575 -509.59677481 -509.59677481 -307.84297859] Freqs [Hz]: [27.755256085280077]
H1s[2][0]  Real Poles: [-770.12330781 -529.15534002 -529.15534002 -103.94984002] Freqs [Hz]: [44.77907331530736]
H1s[2][1]  Real Poles: [-713.1845081  -519.28729735 -519.28729735 -227.5893686 ] Freqs [Hz]: [35.56882183877899]
H1s[2][2]  Real Poles: [-582.14719104 -582.14719104 -421.35310686 -421.35310686] Freqs [Hz]: [12.558015301415443, 15.827992401714145]
H1s[2][3]  Real Poles: [-615.85405264 -615.85405264 -390.15586693 -390.15586693] Freqs [Hz]: [18.8746569518638, 21.216036332834513]
H1s[2][4]  Real Poles: [-668.24029952 -500.4870056  -500.4870056  -325.4438181 ] Freqs [Hz]: [25.683971033299002]
H1s[2][5]  Real Poles: [-769.23881809 -530.5597654  -530.5597654  -112.87344236] Freqs [Hz]: [44.90644106943626]
H1s[2][6]  Real Poles: [-748.41173846 -525.24234613 -525.24234613 -152.48492107] Freqs [Hz]: [41.540086404652556]
H1s[2][7]  Real Poles: [-645.59012998 -645.59012998 -361.53270004 -361.53270004] Freqs [Hz]: [20.560632867946524, 25.937942733020765]
H1s[3][0]  Real Poles: [-635.42691156 -495.22374968 -495.22374968 -374.91596472] Freqs [Hz]: [22.395318066731402]
H1s[3][1]  Real Poles: [-766.81642078 -532.8363014  -532.8363014   -90.31945965] Freqs [Hz]: [45.43676831414454]
H1s[3][2]  Real Poles: [-719.21325867 -525.93788122 -525.93788122 -202.98223385] Freqs [Hz]: [37.019728053625734]
H1s[3][3]  Real Poles: [-704.46269153 -520.66531675 -520.66531675 -233.02031015] Freqs [Hz]: [34.0760972294769]
H1s[3][4]  Real Poles: [-680.2336096  -513.21520043 -513.21520043 -286.70145848] Freqs [Hz]: [30.21049650125422]
H1s[3][5]  Real Poles: [-794.6490034  -534.24006554 -534.24006554  -40.27047454] Freqs [Hz]: [48.920708663926646]
H1s[3][6]  Real Poles: [-699.65367524 -523.10687495 -523.10687495 -232.10035494] Freqs [Hz]: [34.76165371918657]
H1s[3][7]  Real Poles: [-712.21151891 -522.61320529 -522.61320529 -227.6841542 ] Freqs [Hz]: [35.25371604030417]
H1s[4][0]  Real Poles: [-662.6120635  -516.6592761  -516.6592761  -295.36841468] Freqs [Hz]: [26.49716964166312]
H1s[4][1]  Real Poles: [-635.91423046 -635.91423046 -368.43727229 -368.43727229] Freqs [Hz]: [21.270539262081837, 24.106451061748313]
H1s[4][2]  Real Poles: [-715.73046415 -529.65317329 -529.65317329 -195.83117513] Freqs [Hz]: [37.0522137768381]
H1s[4][3]  Real Poles: [-717.01112589 -521.58160795 -521.58160795 -217.90908249] Freqs [Hz]: [35.69883581525129]
H1s[4][4]  Real Poles: [-764.83856313 -525.84588321 -525.84588321 -124.82778226] Freqs [Hz]: [43.682030517069755]
H1s[4][5]  Real Poles: [-661.42053823 -661.42053823 -349.02223559 -349.02223559] Freqs [Hz]: [22.31825772333027, 32.3253087002568]
H1s[4][6]  Real Poles: [-663.18745757 -505.24483356 -505.24483356 -317.48429439] Freqs [Hz]: [27.067208275865923]
H1s[4][7]  Real Poles: [-766.70015065 -530.15821505 -530.15821505 -104.26815236] Freqs [Hz]: [44.47904645044443]
H1s[5][0]  Real Poles: [-648.14775839 -511.83808114 -511.83808114 -318.16543361] Freqs [Hz]: [25.076649704757727]
H1s[5][1]  Real Poles: [-598.2333269  -598.2333269  -401.04311293 -401.04311293] Freqs [Hz]: [17.44324495273555, 14.676172728928245]
H1s[5][2]  Real Poles: [-740.97466524 -530.80151686 -530.80151686 -158.20380824] Freqs [Hz]: [40.889310176921526]
H1s[5][3]  Real Poles: [-612.97069004 -612.97069004 -387.15942683 -387.15942683] Freqs [Hz]: [18.549139131124136, 15.799571413425632]
H1s[5][4]  Real Poles: [-769.6610302  -530.54900761 -530.54900761 -104.62652451] Freqs [Hz]: [45.034203784568]
H1s[5][5]  Real Poles: [-782.8905602  -534.33667199 -534.33667199  -62.77414065] Freqs [Hz]: [47.8399022527055]
H1s[5][6]  Real Poles: [-734.57116912 -526.56391781 -526.56391781 -181.78530958] Freqs [Hz]: [39.48069657811855]
H1s[5][7]  Real Poles: [-592.18373375 -592.18373375 -408.61327727 -408.61327727] Freqs [Hz]: [12.557561620685584, 17.89593495409074]
H1s[6][0]  Real Poles: [-722.92220486 -523.14833907 -523.14833907 -213.45571942] Freqs [Hz]: [36.76366851749146]
H1s[6][1]  Real Poles: [-749.52150115 -531.95712151 -531.95712151 -139.57722517] Freqs [Hz]: [42.1564017038757]
H1s[6][2]  Real Poles: [-700.10683801 -517.0423317  -517.0423317  -246.46084953] Freqs [Hz]: [32.54933903157097]
H1s[6][3]  Real Poles: [-767.08874084 -530.13886351 -530.13886351 -104.80916098] Freqs [Hz]: [44.35792078378934]
H1s[6][4]  Real Poles: [-685.46507494 -513.26775952 -513.26775952 -277.10028601] Freqs [Hz]: [29.803093124599947]
H1s[6][5]  Real Poles: [-675.13059767 -675.13059767 -336.54585911 -336.54585911] Freqs [Hz]: [24.721563955883944, 33.89336485092749]
H1s[6][6]  Real Poles: [-690.86884164 -528.21807591 -528.21807591 -228.16682909] Freqs [Hz]: [33.86286736716384]
H1s[6][7]  Real Poles: [-651.2432537  -651.2432537  -359.12264316 -359.12264316] Freqs [Hz]: [21.302246591068442, 29.125861578438908]
H1s[7][0]  Real Poles: [-724.77057354 -520.56737251 -520.56737251 -203.56554373] Freqs [Hz]: [37.38337645234099]
H1s[7][1]  Real Poles: [-630.75065842 -517.44858097 -517.44858097 -338.22455091] Freqs [Hz]: [22.77047470085854]
H1s[7][2]  Real Poles: [-678.47869892 -514.07477818 -514.07477818 -280.19616407] Freqs [Hz]: [31.025526581566247]
H1s[7][3]  Real Poles: [-667.43202471 -523.40676006 -523.40676006 -273.32439918] Freqs [Hz]: [28.670628136371096]
H1s[7][4]  Real Poles: [-688.85926897 -510.17174086 -510.17174086 -274.99974974] Freqs [Hz]: [31.085457992892138]
H1s[7][5]  Real Poles: [-776.24385292 -532.59651247 -532.59651247  -74.39603654] Freqs [Hz]: [45.61864638390646]
H1s[7][6]  Real Poles: [-710.55643232 -527.79586866 -527.79586866 -208.81701901] Freqs [Hz]: [37.03074991144739]
H1s[7][7]  Real Poles: [-792.21194811 -532.36273593 -532.36273593  -53.87470463] Freqs [Hz]: [48.08881753664082]

C:\src\pecblocks\examples\hwpv>python pv3_training.py
model_folder = ./unbal
model_root = unbal
data_path = ../../../atptools/unbalanced.hdf5
idx_in [0, 1, 2, 3, 4, 5, 6, 7, 8]
idx_out [9, 10, 11, 12, 13, 14, 15, 16]
read 2310 dataframes
dt=0.002000 data_len=2500 n_io=17 n_case=2310
['T', 'G', 'Fc', 'Md', 'Mq', 'Vrms', 'GVrms', 'Ctl', 'Unb'] ['Vdc', 'Idc', 'Idlo', 'Iqlo', 'I0lo', 'Idhi', 'Iqhi', 'I0hi'] (2310, 2500, 17)
shapes of t (2500,) data_train (2310, 2500, 17) n_in=9, n_out=8
t range 0.000000 to 4.998000
Before Scaling:
Column       Min       Max      Mean     Range
T         15.000    35.003    26.754    20.003
G         -0.000   999.995   403.273   999.995
Fc        55.000    65.000    60.002    10.000
Md         0.800     1.200     1.001     0.400
Mq        -0.499     0.501     0.001     1.000
Vrms       0.000   575.565   116.056   575.565
GVrms     -0.000   546.787    69.094   546.787
Ctl        0.000     1.000     0.599     1.000
Unb        0.000     1.000     0.140     1.000
Vdc       -0.000   443.094   273.609   443.094
Idc       -0.000   292.836   103.908   292.836
Idlo      -0.270   189.458    67.640   189.727
Iqlo     -81.686    72.976    -1.439   154.661
I0lo      -0.788     0.496    -0.000     1.283
Idhi      -0.123    15.174     0.621    15.297
Iqhi      -0.288    15.248     0.617    15.536
I0hi      -0.290    14.641     0.614    14.932
After Scaling:
Column       Min       Max      Mean     Range     Scale    Offset
T         -0.588     0.412    -0.000     1.000    20.003    26.754
G         -0.403     0.597    -0.000     1.000   999.995   403.273
Fc        -0.500     0.500    -0.000     1.000    10.000    60.002
Md        -0.502     0.498    -0.000     1.000     0.400     1.001
Mq        -0.500     0.500     0.000     1.000     1.000     0.001
Vrms      -0.202     0.798     0.000     1.000   575.565   116.056
GVrms     -0.126     0.874     0.000     1.000   546.787    69.094
Ctl       -0.599     0.401    -0.000     1.000     1.000     0.599
Unb       -0.140     0.860    -0.000     1.000     1.000     0.140
Vdc       -0.617     0.383    -0.000     1.000   443.094   273.609
Idc       -0.355     0.645     0.000     1.000   292.836   103.908
Idlo      -0.358     0.642     0.000     1.000   189.727    67.640
Iqlo      -0.519     0.481    -0.000     1.000   154.661    -1.439
I0lo      -0.614     0.386     0.000     1.000     1.283    -0.000
Idhi      -0.049     0.951     0.000     1.000    15.297     0.621
Iqhi      -0.058     0.942    -0.000     1.000    15.536     0.617
I0hi      -0.061     0.939    -0.000     1.000    14.932     0.614
make_mimo_block iir
continuing iterations on existing model coefficients
Iter    0 of  600 | Loss     0.002647
Iter   10 of  600 | Loss     0.003648
Iter   20 of  600 | Loss     0.002902
Iter   30 of  600 | Loss     0.002657
Iter   40 of  600 | Loss     0.002670
Iter   50 of  600 | Loss     0.002642
Iter   60 of  600 | Loss     0.002624
Iter   70 of  600 | Loss     0.002615
Iter   80 of  600 | Loss     0.002608
Iter   90 of  600 | Loss     0.002602
Iter  100 of  600 | Loss     0.002596
Iter  110 of  600 | Loss     0.002591
Iter  120 of  600 | Loss     0.002585
Iter  130 of  600 | Loss     0.002579
Iter  140 of  600 | Loss     0.002573
Iter  150 of  600 | Loss     0.002566
Iter  160 of  600 | Loss     0.002560
Iter  170 of  600 | Loss     0.002553
Iter  180 of  600 | Loss     0.002546
Iter  190 of  600 | Loss     0.002539
Iter  200 of  600 | Loss     0.002532
Iter  210 of  600 | Loss     0.002525
Iter  220 of  600 | Loss     0.002517
Iter  230 of  600 | Loss     0.002509
Iter  240 of  600 | Loss     0.002501
Iter  250 of  600 | Loss     0.002493
Iter  260 of  600 | Loss     0.002484
Iter  270 of  600 | Loss     0.002475
Iter  280 of  600 | Loss     0.002466
Iter  290 of  600 | Loss     0.002456
Iter  300 of  600 | Loss     0.002446
Iter  310 of  600 | Loss     0.002436
Iter  320 of  600 | Loss     0.002425
Iter  330 of  600 | Loss     0.002413
Iter  340 of  600 | Loss     0.002401
Iter  350 of  600 | Loss     0.002389
Iter  360 of  600 | Loss     0.002375
Iter  370 of  600 | Loss     0.002361
Iter  380 of  600 | Loss     0.002347
Iter  390 of  600 | Loss     0.002339
Iter  400 of  600 | Loss     0.002316
Iter  410 of  600 | Loss     0.002300
Iter  420 of  600 | Loss     0.002284
Iter  430 of  600 | Loss     0.002266
Iter  440 of  600 | Loss     0.002262
Iter  450 of  600 | Loss     0.002235
Iter  460 of  600 | Loss     0.002215
Iter  470 of  600 | Loss     0.002196
Iter  480 of  600 | Loss     0.002177
Iter  490 of  600 | Loss     0.002171
Iter  500 of  600 | Loss     0.002141
Iter  510 of  600 | Loss     0.002114
Iter  520 of  600 | Loss     0.002106
Iter  530 of  600 | Loss     0.002072
Iter  540 of  600 | Loss     0.002058
Iter  550 of  600 | Loss     0.002132
Iter  560 of  600 | Loss     0.002003
Iter  570 of  600 | Loss     0.002006
Iter  580 of  600 | Loss     0.002173
Iter  590 of  600 | Loss     0.001994
COL_Y ['Vdc', 'Idc', 'Idlo', 'Iqlo', 'I0lo', 'Idhi', 'Iqhi', 'I0hi']
Train time: 49026.92, Recent loss: 0.001969, RMS Errors: 0.0627 0.0267 0.0293 0.0174 0.0115 0.0557 0.0550 0.0571
                          MAE Errors: 0.0388 0.0159 0.0169 0.0096 0.0055 0.0212 0.0212 0.0208

