C:\src\pecblocks\examples\hwpv>python pv3_training.py
model_folder = ./tacs
model_root = tacs
data_path = ../../../atptools/unbalanced.hdf5
idx_in [0, 1, 2, 3, 4, 5, 6, 7, 8]
idx_out [9, 10, 11, 12, 13, 14, 15, 16]
read 2310 dataframes
dt=0.002000 data_len=2500 n_io=17 n_case=2310
['T', 'G', 'Fc', 'Md', 'Mq', 'Vrms', 'GVrms', 'Ctl', 'Unb'] ['Vdc', 'Idc', 'Idlo', 'Iqlo', 'I0lo', 'Idhi', 'Iqhi', 'I0hi'] (2310, 2500, 17)
shapes of t (2500,) data_train (2310, 2500, 17) n_in=9, n_out=8
t range 0.000000 to 4.998000
Before Scaling:
Column       Min       Max      Mean     Range
T         15.000    35.003    26.754    20.003
G         -0.000   999.995   403.273   999.995
Fc        55.000    65.000    60.002    10.000
Md         0.800     1.200     1.001     0.400
Mq        -0.499     0.501     0.001     1.000
Vrms       0.000   575.565   116.056   575.565
GVrms     -0.000   546.787    69.094   546.787
Ctl        0.000     1.000     0.599     1.000
Unb        0.000     1.000     0.140     1.000
Vdc       -0.000   443.094   273.609   443.094
Idc       -0.000   292.836   103.908   292.836
Idlo      -0.270   189.458    67.640   189.727
Iqlo     -81.686    72.976    -1.439   154.661
I0lo      -0.788     0.496    -0.000     1.283
Idhi      -0.123    15.174     0.621    15.297
Iqhi      -0.288    15.248     0.617    15.536
I0hi      -0.290    14.641     0.614    14.932
After Scaling:
Column       Min       Max      Mean     Range     Scale    Offset
T         -0.588     0.412     0.000     1.000    20.003    26.754
G         -0.403     0.597    -0.000     1.000   999.995   403.273
Fc        -0.500     0.500    -0.000     1.000    10.000    60.002
Md        -0.502     0.498    -0.000     1.000     0.400     1.001
Mq        -0.500     0.500     0.000     1.000     1.000     0.001
Vrms      -0.202     0.798     0.000     1.000   575.565   116.056
GVrms     -0.126     0.874     0.000     1.000   546.787    69.094
Ctl       -0.599     0.401    -0.000     1.000     1.000     0.599
Unb       -0.140     0.860     0.000     1.000     1.000     0.140
Vdc       -0.617     0.383     0.000     1.000   443.094   273.609
Idc       -0.355     0.645    -0.000     1.000   292.836   103.908
Idlo      -0.358     0.642    -0.000     1.000   189.727    67.640
Iqlo      -0.519     0.481     0.000     1.000   154.661    -1.439
I0lo      -0.614     0.386     0.000     1.000     1.283    -0.000
Idhi      -0.049     0.951    -0.000     1.000    15.297     0.621
Iqhi      -0.058     0.942    -0.000     1.000    15.536     0.617
I0hi      -0.061     0.939    -0.000     1.000    14.932     0.614
make_mimo_block iir
Iter    0 of  600 | Loss     0.062555
Iter   10 of  600 | Loss     0.047458
Iter   20 of  600 | Loss     0.037915
Iter   30 of  600 | Loss     0.026902
Iter   40 of  600 | Loss     0.018811
Iter   50 of  600 | Loss     0.014502
Iter   60 of  600 | Loss     0.012672
Iter   70 of  600 | Loss     0.011094
Iter   80 of  600 | Loss     0.010184
Iter   90 of  600 | Loss     0.009448
Iter  100 of  600 | Loss     0.008778
Iter  110 of  600 | Loss     0.008022
Iter  120 of  600 | Loss     0.007073
Iter  130 of  600 | Loss     0.006424
Iter  140 of  600 | Loss     0.006130
Iter  150 of  600 | Loss     0.005928
Iter  160 of  600 | Loss     0.005789
Iter  170 of  600 | Loss     0.005677
Iter  180 of  600 | Loss     0.005582
Iter  190 of  600 | Loss     0.005501
Iter  200 of  600 | Loss     0.005425
Iter  210 of  600 | Loss     0.005348
Iter  220 of  600 | Loss     0.005262
Iter  230 of  600 | Loss     0.005160
Iter  240 of  600 | Loss     0.005036
Iter  250 of  600 | Loss     0.004885
Iter  260 of  600 | Loss     0.004702
Iter  270 of  600 | Loss     0.004489
Iter  280 of  600 | Loss     0.004258
Iter  290 of  600 | Loss     0.004040
Iter  300 of  600 | Loss     0.003849
Iter  310 of  600 | Loss     0.004376
Iter  320 of  600 | Loss     0.003682
Iter  330 of  600 | Loss     0.003421
Iter  340 of  600 | Loss     0.003270
Iter  350 of  600 | Loss     0.003341
Iter  360 of  600 | Loss     0.003108
Iter  370 of  600 | Loss     0.003048
Iter  380 of  600 | Loss     0.002989
Iter  390 of  600 | Loss     0.003547
Iter  400 of  600 | Loss     0.003090
Iter  410 of  600 | Loss     0.003045
Iter  420 of  600 | Loss     0.002932
Iter  430 of  600 | Loss     0.002891
Iter  440 of  600 | Loss     0.002850
Iter  450 of  600 | Loss     0.002821
Iter  460 of  600 | Loss     0.002802
Iter  470 of  600 | Loss     0.002780
Iter  480 of  600 | Loss     0.002762
Iter  490 of  600 | Loss     0.002824
Iter  500 of  600 | Loss     0.002738
Iter  510 of  600 | Loss     0.002744
Iter  520 of  600 | Loss     0.002790
Iter  530 of  600 | Loss     0.002694
Iter  540 of  600 | Loss     0.002678
Iter  550 of  600 | Loss     0.002720
Iter  560 of  600 | Loss     0.002683
Iter  570 of  600 | Loss     0.002684
Iter  580 of  600 | Loss     0.002693
Iter  590 of  600 | Loss     0.002673
COL_Y ['Vdc', 'Idc', 'Idlo', 'Iqlo', 'I0lo', 'Idhi', 'Iqhi', 'I0hi']
Train time: 35250.36, Recent loss: 0.002649, RMS Errors: 0.0821 0.0382 0.0317 0.0346 0.0129 0.0592 0.0590 0.0603
                          MAE Errors: 0.0568 0.0246 0.0205 0.0204 0.0070 0.0254 0.0242 0.0231

C:\src\pecblocks\examples\hwpv>python pv3_export.py
Read Model from: ./tacs/tacs_config.json
Export Model to: ./tacs\tacs_fhf.json
idx_in [0, 1, 2, 3, 4, 5, 6, 7, 8]
idx_out [9, 10, 11, 12, 13, 14, 15, 16]
make_mimo_block iir
H1s[0][0]  Real Poles: [-786.52453661 -536.68612667 -536.68612667  -45.52700772] Freqs [Hz]: [47.94030220048266]
H1s[0][1]  Real Poles: [-585.61780416 -585.61780416 -413.02472823 -413.02472823] Freqs [Hz]: [16.90321936266029, 8.539084744033532]
H1s[0][2]  Real Poles: [-719.73924336 -516.86085932 -516.86085932 -225.16170177] Freqs [Hz]: [35.51790986800263]
H1s[0][3]  Real Poles: [-698.21638958 -509.90837977 -509.90837977 -264.13262893] Freqs [Hz]: [32.08721650259873]
H1s[0][4]  Real Poles: [-724.7409802  -517.87129614 -517.87129614 -216.43717751] Freqs [Hz]: [37.314906525376266]
H1s[0][5]  Real Poles: [-760.19137818 -532.99694023 -532.99694023 -110.02922563] Freqs [Hz]: [44.04392531636852]
H1s[0][6]  Real Poles: [-696.58406337 -520.87282985 -520.87282985 -246.36326863] Freqs [Hz]: [33.53458262167607]
H1s[0][7]  Real Poles: [-790.0359951  -533.93268493 -533.93268493  -37.75496742] Freqs [Hz]: [49.229512734947974]
H1s[1][0]  Real Poles: [-706.84268725 -531.92333691 -531.92333691 -196.41480567] Freqs [Hz]: [36.60868848052171]
H1s[1][1]  Real Poles: [-786.29992677 -536.72640594 -536.72640594  -38.39345111] Freqs [Hz]: [47.87581494347202]
H1s[1][2]  Real Poles: [-776.88299382 -528.31093547 -528.31093547  -90.91273529] Freqs [Hz]: [45.94863899275461]
H1s[1][3]  Real Poles: [-668.95493251 -500.26071462 -500.26071462 -329.9980513 ] Freqs [Hz]: [26.82063510245352]
H1s[1][4]  Real Poles: [-722.7304403  -511.99113188 -511.99113188 -240.30299684] Freqs [Hz]: [34.940035807633656]
H1s[1][5]  Real Poles: [-644.02233093 -509.86446775 -509.86446775 -325.84050717] Freqs [Hz]: [24.79283812211071]
H1s[1][6]  Real Poles: [-726.6022251  -520.70094396 -520.70094396 -203.92906744] Freqs [Hz]: [37.61380787272219]
H1s[1][7]  Real Poles: [-727.74117155 -526.41999253 -526.41999253 -180.95395818] Freqs [Hz]: [38.429757030963096]
H1s[2][0]  Real Poles: [-779.02098276 -533.85873115 -533.85873115  -80.74664842] Freqs [Hz]: [46.914770736061506]
H1s[2][1]  Real Poles: [-671.60007947 -514.79285848 -514.79285848 -285.56287286] Freqs [Hz]: [28.183406237951054]
H1s[2][2]  Real Poles: [-701.0792609  -508.25438454 -508.25438454 -273.00646416] Freqs [Hz]: [31.539678216887875]
H1s[2][3]  Real Poles: [-676.22880952 -499.01811366 -499.01811366 -320.0749373 ] Freqs [Hz]: [28.136080526722083]
H1s[2][4]  Real Poles: [-738.95007086 -527.52490415 -527.52490415 -167.30665927] Freqs [Hz]: [40.39646578105544]
H1s[2][5]  Real Poles: [-754.56746411 -529.79865354 -529.79865354 -131.05471949] Freqs [Hz]: [42.15499964662544]
H1s[2][6]  Real Poles: [-697.90845366 -522.57574509 -522.57574509 -232.15096496] Freqs [Hz]: [34.29805595026298]
H1s[2][7]  Real Poles: [-759.37255494 -527.6462853  -527.6462853  -133.48916002] Freqs [Hz]: [42.57022118716337]
H1s[3][0]  Real Poles: [-706.52901294 -516.22048227 -516.22048227 -249.2959327 ] Freqs [Hz]: [34.190132865564486]
H1s[3][1]  Real Poles: [-608.80243594 -608.80243594 -394.21711325 -394.21711325] Freqs [Hz]: [14.13293159414079, 21.218877427578732]
H1s[3][2]  Real Poles: [-731.2617427  -530.94153811 -530.94153811 -167.98689164] Freqs [Hz]: [39.41367577092555]
H1s[3][3]  Real Poles: [-733.46679282 -528.076693   -528.076693   -173.45025104] Freqs [Hz]: [39.21953228421076]
H1s[3][4]  Real Poles: [-640.37762551 -514.6853829  -514.6853829  -322.26185006] Freqs [Hz]: [24.65155643558847]
H1s[3][5]  Real Poles: [-671.55536542 -517.68839154 -517.68839154 -281.37091493] Freqs [Hz]: [28.207729505824172]
H1s[3][6]  Real Poles: [-713.60612174 -525.17201354 -525.17201354 -207.56237373] Freqs [Hz]: [36.22500206527089]
H1s[3][7]  Real Poles: [-763.60048692 -525.46555316 -525.46555316 -129.22698014] Freqs [Hz]: [43.33386782875708]
H1s[4][0]  Real Poles: [-759.16481972 -523.1246358  -523.1246358  -152.07419964] Freqs [Hz]: [42.304908491757466]
H1s[4][1]  Real Poles: [-718.6391279 -522.4465141 -522.4465141 -210.4245499] Freqs [Hz]: [37.062917991888455]
H1s[4][2]  Real Poles: [-647.59217829 -506.48471098 -506.48471098 -343.18743971] Freqs [Hz]: [23.31539033804565]
H1s[4][3]  Real Poles: [-633.54908596 -505.40583043 -505.40583043 -350.85300672] Freqs [Hz]: [21.88469039150568]
H1s[4][4]  Real Poles: [-730.26099167 -524.74801236 -524.74801236 -177.68346419] Freqs [Hz]: [38.902328859346426]
H1s[4][5]  Real Poles: [-793.97987708 -537.23796812 -537.23796812  -28.31412008] Freqs [Hz]: [50.0252350028284]
H1s[4][6]  Real Poles: [-571.07536554 -571.07536554 -486.39514218 -365.94788411] Freqs [Hz]: [15.832767794436688]
H1s[4][7]  Real Poles: [-746.82445958 -522.17380848 -522.17380848 -178.63454245] Freqs [Hz]: [40.88549875052824]
H1s[5][0]  Real Poles: [-787.17847521 -537.69471648 -537.69471648  -46.3533783 ] Freqs [Hz]: [49.192945129316044]
H1s[5][1]  Real Poles: [-609.18510043 -609.18510043 -392.29022687 -392.29022687] Freqs [Hz]: [18.170136712843725, 18.316465128369174]
H1s[5][2]  Real Poles: [-653.19418807 -509.70171555 -509.70171555 -316.52283256] Freqs [Hz]: [25.22213621296061]
H1s[5][3]  Real Poles: [-711.62543772 -519.88088885 -519.88088885 -228.25980445] Freqs [Hz]: [35.38030796493422]
H1s[5][4]  Real Poles: [-536.22068226 -536.22068226 -514.56499238 -418.21427145] Freqs [Hz]: [11.577744951837289]
H1s[5][5]  Real Poles: [-703.07617782 -518.38169476 -518.38169476 -238.55811683] Freqs [Hz]: [33.06221120674292]
H1s[5][6]  Real Poles: [-720.01855233 -519.22540102 -519.22540102 -215.89964814] Freqs [Hz]: [36.21175748836413]
H1s[5][7]  Real Poles: [-736.57265677 -523.2766994  -523.2766994  -173.29342725] Freqs [Hz]: [38.90439465953462]
H1s[6][0]  Real Poles: [-708.78816835 -530.318716   -530.318716   -206.51800413] Freqs [Hz]: [35.426144753485964]
H1s[6][1]  Real Poles: [-732.02536599 -519.61161862 -519.61161862 -205.00411654] Freqs [Hz]: [37.2886535972017]
H1s[6][2]  Real Poles: [-688.93550861 -499.52316116 -499.52316116 -310.9322338 ] Freqs [Hz]: [29.382398630733874]
H1s[6][3]  Real Poles: [-619.0924311  -619.0924311  -380.39725622 -380.39725622] Freqs [Hz]: [17.16211128664543, 22.79600592163872]
H1s[6][4]  Real Poles: [-718.2365233  -512.24746059 -512.24746059 -244.50470326] Freqs [Hz]: [34.28405499944828]
H1s[6][5]  Real Poles: [-601.64598445 -520.69632265 -520.69632265 -354.56459088] Freqs [Hz]: [18.11400175925064]
H1s[6][6]  Real Poles: [-660.65684727 -514.11402895 -514.11402895 -306.56604505] Freqs [Hz]: [27.601073493479298]
H1s[6][7]  Real Poles: [-586.02904275 -515.12760949 -515.12760949 -385.55519174] Freqs [Hz]: [15.567192491995625]
H1s[7][0]  Real Poles: [-687.19901929 -514.65690546 -514.65690546 -264.35671073] Freqs [Hz]: [30.106597096087086]
H1s[7][1]  Real Poles: [-8.15308259e+02 -5.37548763e+02 -5.37548763e+02 -3.79178493e-01] Freqs [Hz]: [52.41060996407605]
H1s[7][2]  Real Poles: [-786.91121506 -528.31533336 -528.31533336  -56.82999011] Freqs [Hz]: [47.572306317160496]
H1s[7][3]  Real Poles: [-727.66382206 -517.17860651 -517.17860651 -197.27908806] Freqs [Hz]: [37.40005270522212]
H1s[7][4]  Real Poles: [-747.18591303 -527.74956859 -527.74956859 -141.26333416] Freqs [Hz]: [41.69371537510336]
H1s[7][5]  Real Poles: [-622.79394723 -519.78813252 -519.78813252 -339.6762748 ] Freqs [Hz]: [22.95666913101359]
H1s[7][6]  Real Poles: [-701.18059491 -530.91937461 -530.91937461 -208.05981353] Freqs [Hz]: [35.83510094260261]
H1s[7][7]  Real Poles: [-785.74549153 -531.34537702 -531.34537702  -63.69472867] Freqs [Hz]: [47.127884981830846]

